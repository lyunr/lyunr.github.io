<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>正在跳转...</title>
    <script>
        // 获取URL参数中的加密链接
        function getUrlParam(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return decodeURIComponent(r[2]);
            return null;
        }
        
        // 从URL中获取原始链接
        function getOriginalUrl() {
            // 方式1：从c参数获取base64编码的URL
            var encodedUrl = getUrlParam('c');
            if (encodedUrl) {
                try {
                    return atob(encodedUrl);
                } catch (e) {
                    console.error("Base64解码失败:", e);
                }
            }
            
            // 方式2：从redirect参数获取直接URL编码的URL
            var redirectUrl = getUrlParam('redirect');
            if (redirectUrl) {
                return redirectUrl;
            }
            
            return null;
        }
        
        // 主跳转逻辑
        function redirect() {
            var originalUrl = getOriginalUrl();
            
            if (originalUrl) {
                // 验证URL格式
                if (!/^https?:\/\//i.test(originalUrl)) {
                    originalUrl = 'http://' + originalUrl;
                }
                
                // 延迟跳转，增加防红效果
                setTimeout(function() {
                    window.location.href = originalUrl;
                }, 500); // 500毫秒延迟可以增加防红效果
                
                document.getElementById('status').innerHTML = '正在跳转到目标链接，请稍候...';
                document.getElementById('directLink').href = originalUrl;
                document.getElementById('directLink').innerHTML = originalUrl;
            } else {
                document.getElementById('status').innerHTML = '未找到有效的跳转链接';
            }
        }
        
        // 页面加载后执行跳转
        window.onload = function() {
            redirect();
        };
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #444;
            font-size: 24px;
        }
        #status {
            margin: 20px 0;
            font-size: 16px;
        }
        #directLink {
            display: block;
            margin: 20px 0;
            word-break: break-all;
            color: #06c;
            text-decoration: none;
        }
        #directLink:hover {
            text-decoration: underline;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0,0,0,.1);
            border-radius: 50%;
            border-top-color: #06c;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
            vertical-align: middle;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>链接跳转中</h1>
        <div id="status">
            <span class="loading"></span>正在验证链接...
        </div>
        <a id="directLink" href="#" target="_blank" style="display:none;">如果页面没有自动跳转，请点击这里</a>
    </div>
</body>
</html>